<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Donate</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .amounts {
            margin: 12px 0;
        }

        .amounts button {
            margin: 4px;
            padding: 8px 12px;
        }

        .active {
            background: #0070ba;
            color: #fff;
            border: none;
        }

        #custom-amount {
            width: 90px;
            padding: 6px;
        }
    </style>

    <script
        src="https://www.paypal.com/sdk/js?client-id=AWXiLk5YzaHQXWeE7asEGI2j1gCP3gbWw4Kq89QXRl5Lfst4S32h7K46LZuV0bi1r-M38LP_Mkod9K14"></script>
</head>

<body>
    <div class="container">
        <div class="row justify-content-center align-items-center min-vh-100">
            <div class="col-12 col-md-8 col-lg-5">
                <div class="card shadow rounded-4 text-center p-5 bg-white">
                    <h1 class="h3 mb-2 bg-dark text-white rounded-2 p-2 mb-4">DONATE</h1>

                    <div class="mb-3 text-start">
                        <label for="donorName" class="form-label">Name (optional)</label>
                        <input id="donorName" type="text" class="form-control" placeholder="ex: John Doe">
                    </div>

                    <div class="my-3 text-start">
                        <label for="custom-amount" class="form-label d-block mb-2">Amount</label>

                        <div class="amounts">
                            <span style="display:block; margin-bottom:10px;">
                                <input id="custom-amount" type="number" min="0.01" step="0.01" value="1.00"
                                    placeholder="Must be greater than 0." class="w-100" />
                            </span>
                            <div class="d-flex justify-content-center gap-2">
                                <button data-amount="5.00" class="preset btn btn-outline-primary btn-sm">$5</button>
                                <button data-amount="10.00" class="preset btn btn-outline-primary btn-sm">$10</button>
                                <button data-amount="50.00" class="preset btn btn-outline-primary btn-sm">$50</button>
                                <button data-amount="100.00" class="preset btn btn-outline-primary btn-sm">$100</button>
                            </div>

                        </div>

                    </div>
                    <div id="paypal-button-container"></div>
                </div>
            </div>
        </div>


        <script>
            // default selected amount
            let selectedAmount = "1.00";

            // helper to format
            function fmt(v) {
                return parseFloat(v || 0).toFixed(2);
            }

            // wire preset buttons
            document.querySelectorAll('.preset').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.preset').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    selectedAmount = fmt(btn.getAttribute('data-amount'));
                    // reflect the chosen preset into the custom input
                    const custom = document.getElementById('custom-amount');
                    if (custom) custom.value = selectedAmount;
                    document.getElementById('selected').textContent = 'Selected: $' + selectedAmount;
                });
            });

            // custom amount: update selection live as user types
            document.getElementById('custom-amount').addEventListener('input', () => {
                const val = document.getElementById('custom-amount').value;
                const num = parseFloat(val);
                if (isNaN(num) || num <= 0) {
                    // don't update selection for invalid values
                    return;
                }
                // deactivate presets visually
                document.querySelectorAll('.preset').forEach(b => b.classList.remove('active'));
                selectedAmount = fmt(num);
                document.getElementById('selected').textContent = 'Selected: $' + selectedAmount;
            });

            // render PayPal button once; createOrder reads selectedAmount at click time
            paypal.Buttons({
                onClick: function (data, actions) {
                    // validate before proceed
                    const amt = parseFloat(selectedAmount);
                    if (isNaN(amt) || amt <= 0) {
                        alert('Please select or enter a valid amount.');
                        return actions.reject();
                    }
                    return actions.resolve();
                },
                createOrder: function (data, actions) {
                    return actions.order.create({
                        purchase_units: [{
                            amount: { value: selectedAmount }
                        }]
                    });
                },
                onApprove: function (data, actions) {
                    return actions.order.capture().then(function (details) {
                        // simple confirmation
                        const payerName = details.payer && details.payer.name && details.payer.name.given_name ? details.payer.name.given_name : 'Customer';
                        alert('Transaction completed by ' + payerName + '\nAmount: $' + selectedAmount);
                        console.log(details);
                    });
                },
                onError: function (err) {
                    console.error(err);
                    alert('An error occurred during the transaction.');
                }
            }).render('#paypal-button-container');
        </script>

</body>

</html>